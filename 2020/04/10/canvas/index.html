<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>18ã€å¦‚ä½•ä½¿ç”¨canvaså‹ç¼©å›¾ç‰‡ï¼Ÿ</title><meta name="description" content="ğŸ¯ ğŸ¯ ğŸ¯ ğŸ¯ ğŸ¯"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
canvas æ˜¯ HTML5 çš„æ–°ç‰¹æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨ canvas å…ƒç´ åœ¨ç½‘é¡µä¸Šé€šè¿‡ JavaScript ç»˜åˆ¶å›¾åƒ ï¼ˆå¯ä»¥åœ¨ HTML é¡µé¢ä½¿ç”¨å¤šä¸ª canvas å…ƒç´ ï¼‰






1ã€ç»˜å›¾æµç¨‹:
// 1ã€ç¼–å†™canvasæ ‡ç­¾ï¼ŒæŒ‡å®šå®½é«˜ï¼ˆæ³¨æ„ï¼‰ï¼›
&amp;lt;canvas id=&amp;quot;canvas&amp;quot; width=&amp;quot;800&amp;quot; height=&amp;quot;800&amp;quot;&amp;gt;&amp;lt;/canvas&amp;gt;;
// 2ã€è·å–canvas DOMå¯¹è±¡ï¼›
const canvas = document.getElementById(&amp;quot;canvas&amp;quot;);
// 3ã€è·å–Canvaså¯¹è±¡ï¼›
const ctx = canvas.getContext(&amp;qu.."><meta name="generator" content="Hexo 5.4.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">18ã€å¦‚ä½•ä½¿ç”¨canvaså‹ç¼©å›¾ç‰‡ï¼Ÿ</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">ç‚¹å‡»è¿”å›é¡¶éƒ¨</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/about">å…³äº</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/about">å…³äº</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile is-hidden"></div><div class="column is-9"><header class="my-4"><a href="/tags/canvas"><i class="tag post-item-tag">canvas</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">18ã€å¦‚ä½•ä½¿ç”¨canvaså‹ç¼©å›¾ç‰‡ï¼Ÿ</h1><time class="has-text-grey" datetime="2020-04-10T12:00:00.000Z">2020-04-10</time><article class="mt-2 post-content"><blockquote>
<p>canvas æ˜¯ HTML5 çš„æ–°ç‰¹æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨ canvas å…ƒç´ åœ¨ç½‘é¡µä¸Šé€šè¿‡ JavaScript ç»˜åˆ¶å›¾åƒ ï¼ˆå¯ä»¥åœ¨ HTML é¡µé¢ä½¿ç”¨å¤šä¸ª canvas å…ƒç´ ï¼‰</p>
</blockquote>
<span id="more"></span>




<p><strong>1ã€ç»˜å›¾æµç¨‹:</strong></p>
<pre><code class="js">// 1ã€ç¼–å†™canvasæ ‡ç­¾ï¼ŒæŒ‡å®šå®½é«˜ï¼ˆæ³¨æ„ï¼‰ï¼›
&lt;canvas id=&quot;canvas&quot; width=&quot;800&quot; height=&quot;800&quot;&gt;&lt;/canvas&gt;;
// 2ã€è·å–canvas DOMå¯¹è±¡ï¼›
const canvas = document.getElementById(&quot;canvas&quot;);
// 3ã€è·å–Canvaså¯¹è±¡ï¼›
const ctx = canvas.getContext(&quot;2d&quot;); // æ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•
// 4ã€è®¾ç½®ç»˜å›¾å±æ€§ï¼›
ctx.fillStyle = &quot;red&quot;; //è®¾ç½®å¡«å……è‰²
// 5ã€è°ƒç”¨ç»˜å›¾APIã€‚
ctx.fillRect(0, 0, 50, 50); // ç»˜åˆ¶çŸ©å½¢
</code></pre>
<p><strong>2ã€canvas è·¯å¾„</strong></p>
<p>å¸¸ç”¨çš„æ–¹æ³•ï¼š</p>
<p>ï¼ˆ1ï¼‰moveTo(x,y)â€“å®šä¹‰çº¿æ¡å¼€å§‹åæ ‡</p>
<p>ï¼ˆ2ï¼‰lineTo(x,y)â€“å®šä¹‰çº¿æ¡ç»“æŸåæ ‡</p>
<p>ç¤ºä¾‹ 1ã€ç»˜åˆ¶çº¿æ®µ</p>
<pre><code class="js">&lt;canvas id=&quot;canvas&quot; width=&quot;800&quot; height=&quot;800&quot;&gt;&lt;/canvas&gt;;
var canvas = document.getElementById(&quot;canvas&quot;);
var ctx = canvas.getContext(&quot;2d&quot;);
ctx.beginPath(); // å¼€å§‹ç»˜åˆ¶è·¯å¾„
ctx.lineWidth = 1; // çº¿æ¡å®½åº¦
ctx.strokeStyle = &quot;green&quot;; // çº¿æ¡å¡«å……è‰²
ctx.moveTo(0, 0);
ctx.lineTo(200, 100);
ctx.stroke(); // ç»˜åˆ¶çº¿æ®µ
</code></pre>
<p>ç¤ºä¾‹ 2ã€ç»˜åˆ¶åœ†å½¢</p>
<p>arc(x,y,r,start,stop) x è½´ y è½´ r åŠå¾„</p>
<pre><code class="js">&lt;canvas id=&quot;canvas&quot; width=&quot;800&quot; height=&quot;800&quot;&gt;&lt;/canvas&gt;;
var canvas = document.getElementById(&quot;canvas&quot;);
var ctx = canvas.getContext(&quot;2d&quot;);
ctx.beginPath();
ctx.lineWidth = 2;
ctx.strokeStyle = &quot;green&quot;; // åœ†å½¢è¾¹æ¡†è‰²
ctx.fillStyle = &quot;red&quot;; // åœ†å½¢å¡«å……è‰²
ctx.arc(95, 50, 40, 0, 2 * Math.PI);
ctx.stroke();
</code></pre>
<p>ç¤ºä¾‹ 3ã€ç»˜åˆ¶çŸ©å½¢ ï¼ˆä»£ç è§ç»˜å›¾æµç¨‹ï¼‰</p>
<p><strong>3ã€ä½¿ç”¨ canvas å‹ç¼©å›¾ç‰‡</strong></p>
<pre><code class="html">&lt;!--ç¼–å†™inputæ ‡ç­¾ æŒ‡å®štypeç±»å‹ä¸ºfile--&gt;
&lt;input type=&quot;file&quot; id=&quot;upload&quot; /&gt;
</code></pre>
<details>
<summary>å‹ç¼©å›¾ç‰‡jsä»£ç (ç‚¹å‡»å±•å¼€)</summary>

<pre><code class="js">// è®¾ç½®ä¸Šä¼ å›¾ç‰‡ç±»å‹  ä¸Šä¼ å›¾ç‰‡çš„å®¹é‡å¤§å°
const ACCEPT = [&quot;image/jpg&quot;, &quot;image/png&quot;, &quot;image/jpeg&quot;]; // é™å®šå›¾ç‰‡æ–‡ä»¶ç±»å‹
const MAXSIZE = 1024 * 1024 * 3; // é™å®šå›¾ç‰‡æœ€å¤§å®¹é‡
const MAXSIZE_STR = &quot;3MB&quot;;

function convertImageToBase64(file, cb) &#123;
  let reader = new FileReader();
  reader.addEventListener(&quot;load&quot;, function (e) &#123;
    const base64Image = e.target.result; // è·å–æ–‡ä»¶å†…å®¹ï¼Œç­‰åŒäº reader.result
    cb(base64Image);
    reader = null;
  &#125;);
  reader.readAsDataURL(file); // è¯»å– file å¯¹è±¡ä¸­çš„å†…å®¹
&#125;
// å›¾ç‰‡æ˜¯å¦å‹ç¼©çš„åˆ¤æ–­
function compress(base64Image, cb) &#123;
  let maxW = 1024;
  let maxH = 1024;
  const image = new Image();
  image.addEventListener(&quot;load&quot;, function () &#123;
    let ratio; // å‹ç¼©æ¯”
    let needCompress = false; // æ˜¯å¦éœ€è¦å‹ç¼©
    if (maxW &lt; image.naturalWidth) &#123;
      needCompress = true;
      ratio = image.naturalWidth / maxW;
      maxH = image.naturalHeight / ratio;
    &#125;
    if (maxH &lt; image.naturalHeight) &#123;
      needCompress = true;
      ratio = image.naturalHeight / maxH;
      maxW = image.naturalWidth / ratio;
    &#125;
    if (!needCompress) &#123;
      maxW = image.naturalWidth;
      maxH = image.naturalHeight;
    &#125;
    const canvas = document.createElement(&quot;canvas&quot;);
    canvas.setAttribute(&quot;id&quot;, &quot;__compress__&quot;);
    canvas.width = maxW;
    canvas.height = maxH;
    canvas.style.visibility = &quot;hidden&quot;;
    document.body.append(canvas);
    // canvasç”»å¸ƒ
    const ctx = canvas.getContext(&quot;2d&quot;);
    ctx.clearRect(0, 0, maxW, maxH);
    ctx.drawImage(image, 0, 0, maxW, maxH); // æ¸²æŸ“å›¾ç‰‡
    const compressImage = canvas.toDataURL(&quot;image/jpeg&quot;, 0.9); // å‹ç¼©å›¾ç‰‡
    cb(compressImage);
    const _image = new Image();
    _image.src = compressImage;
    document.body.appendChild(_image);
    canvas.remove(); // ç§»é™¤ canvas
  &#125;);
  image.src = base64Image; // å°†å›¾ç‰‡è®¾ç½®åˆ° image çš„ src å±æ€§ä¸­
  document.body.appendChild(image);
&#125;
// ä¸Šä¼ ç»™æœåŠ¡ç«¯
function uploadImage(compressImage) &#123;
  console.log(&quot;upload image to server...&quot;, compressImage);
&#125;

const upload = document.getElementById(&quot;upload&quot;);
upload.addEventListener(&quot;change&quot;, function (e) &#123;
  const file = e.target.files[0];
  console.log(file);
  if (!file) &#123;
    return;
  &#125;
  const &#123; type: fileType, size: fileSize &#125; = file;
  // å›¾ç‰‡ç±»å‹æ£€æŸ¥
  if (!ACCEPT.includes(fileType)) &#123;
    alert(&quot;ä¸æ”¯æŒä¸Šä¼ è¯¥æ ¼å¼æ–‡ä»¶ï¼&quot;);
    upload.value = &quot;&quot;;
    return;
  &#125;
  // å›¾ç‰‡å¤§å°æ£€æŸ¥
  if (fileSize &gt; MAXSIZE) &#123;
    alert(&quot;æ–‡ä»¶è¶…å‡º&quot; + MAXSIZE_STR + &quot;ï¼&quot;);
    upload.value = &quot;&quot;;
    return;
  &#125;
  // å‹ç¼©æ–‡ä»¶
  convertImageToBase64(file, (base64Image) =&gt;
    compress(base64Image, uploadImage)
  );
&#125;);
</code></pre>
</details></article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2020/04/20/echarts/" title="19ã€å…³äºechartså®˜æ–¹çš„ä¸€ä¸ªbug -- sublinkè·³è½¬é—®é¢˜"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">ä¸Šä¸€é¡µ: 19ã€å…³äºechartså®˜æ–¹çš„ä¸€ä¸ªbug -- sublinkè·³è½¬é—®é¢˜</span></a><a class="button is-default" href="/2020/02/20/mobile/" title="17ã€ç§»åŠ¨ç«¯300mså»¶è¿Ÿåœ¨IOS11ä¸­çš„bug"><span class="has-text-weight-semibold">ä¸‹ä¸€é¡µ: 17ã€ç§»åŠ¨ç«¯300mså»¶è¿Ÿåœ¨IOS11ä¸­çš„bug</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- çŸ¥ä¹--><!-- é¢†è‹±--><!-- è„¸ä¹¦--></section><p><span>Copyright Â©</span><span> Jude 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>