<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>Vueé¡¹ç›®ä¸­å‰ç«¯å¯¼å‡º/å¯¼å…¥Excelè¡¨æ ¼çš„å®ç°</title><meta name="description" content="ğŸ¯ ğŸ¯ ğŸ¯ ğŸ¯ ğŸ¯"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="åå°ç®¡ç†ç³»ç»Ÿä¸­ï¼Œé€šå¸¸æœ‰è¿™æ ·çš„éœ€æ±‚:å°†å½“å‰ table è¡¨æ ¼å¯¼å‡º/å¯¼å…¥ Excel è¡¨æ ¼ï¼Œå®ç°æ–¹å¼é€šå¸¸ä¸ºåç«¯ä¸»å¯¼ï¼ˆåç«¯ä½¿ç”¨æ’ä»¶ï¼Œå‰ç«¯é€šè¿‡ç‚¹å‡»äº‹ä»¶ç”Ÿæˆä¸€ä¸ª a æ ‡ç­¾ï¼Œå¯¼å‡º Excel è¡¨æ ¼ï¼‰ã€å‰ç«¯ä¸»å¯¼ï¼ˆä½¿ç”¨ xlsxã€file-saverã€script-loader æ’ä»¶å°è£…å·¥å…·å‡½æ•°ï¼Œé€šè¿‡ç‚¹å‡»äº‹ä»¶ï¼Œè·å–å½“å‰é¡µé¢åå°è¿”å›çš„è¡¨æ ¼æ•°æ®)ã€‚


ä¸€ã€å‰ç«¯å¯¼å‡º Excel è¡¨æ ¼çš„å®ç°1ã€å®‰è£… pluginnpm install file-saver script-loader xlsx --save

2ã€Export2Excel å·¥å…·å‡½æ•°
ç‚¹æˆ‘å±•ç¤ºä»£ç 

import &amp;#123; saveAs &amp;#125; from &amp;quot;file-saver&amp;quot;;
import XLSX from &amp;quot;xls.."><meta name="generator" content="Hexo 5.4.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Vueé¡¹ç›®ä¸­å‰ç«¯å¯¼å‡º/å¯¼å…¥Excelè¡¨æ ¼çš„å®ç°</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">ç‚¹å‡»è¿”å›é¡¶éƒ¨</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/about">å…³äº</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/about">å…³äº</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%87%BA-Excel-%E8%A1%A8%E6%A0%BC%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">ä¸€ã€å‰ç«¯å¯¼å‡º Excel è¡¨æ ¼çš„å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85-plugin"><span class="toc-text">1ã€å®‰è£… plugin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81Export2Excel-%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0"><span class="toc-text">2ã€Export2Excel å·¥å…·å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%AF%BC%E5%87%BA%E5%87%BD%E6%95%B0"><span class="toc-text">3ã€å¯¼å‡ºå‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%89%8D%E7%AB%AF%E5%AF%BC%E5%85%A5-Excel-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">äºŒã€å‰ç«¯å¯¼å…¥ Excel çš„å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81ant-design-vue-%E4%B8%8A%E4%BC%A0%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">1ã€ant-design-vue ä¸Šä¼ ç»„ä»¶çš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%AF%BC%E5%85%A5%E5%87%BD%E6%95%B0"><span class="toc-text">2ã€å¯¼å…¥å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81table-%E5%AD%90%E7%BB%84%E4%BB%B6"><span class="toc-text">ä¸‰ã€table å­ç»„ä»¶</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/vue"><i class="tag post-item-tag">vue</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Vueé¡¹ç›®ä¸­å‰ç«¯å¯¼å‡º/å¯¼å…¥Excelè¡¨æ ¼çš„å®ç°</h1><time class="has-text-grey" datetime="2022-01-14T16:00:00.000Z">2022-01-15</time><article class="mt-2 post-content"><p>åå°ç®¡ç†ç³»ç»Ÿä¸­ï¼Œé€šå¸¸æœ‰è¿™æ ·çš„éœ€æ±‚:å°†å½“å‰ table è¡¨æ ¼å¯¼å‡º/å¯¼å…¥ Excel è¡¨æ ¼ï¼Œå®ç°æ–¹å¼é€šå¸¸ä¸ºåç«¯ä¸»å¯¼ï¼ˆåç«¯ä½¿ç”¨æ’ä»¶ï¼Œå‰ç«¯é€šè¿‡ç‚¹å‡»äº‹ä»¶ç”Ÿæˆä¸€ä¸ª a æ ‡ç­¾ï¼Œå¯¼å‡º Excel è¡¨æ ¼ï¼‰ã€å‰ç«¯ä¸»å¯¼ï¼ˆä½¿ç”¨ xlsxã€file-saverã€script-loader æ’ä»¶å°è£…å·¥å…·å‡½æ•°ï¼Œé€šè¿‡ç‚¹å‡»äº‹ä»¶ï¼Œè·å–å½“å‰é¡µé¢åå°è¿”å›çš„è¡¨æ ¼æ•°æ®)ã€‚</p>
<span id="more"></span>

<h2 id="ä¸€ã€å‰ç«¯å¯¼å‡º-Excel-è¡¨æ ¼çš„å®ç°"><a href="#ä¸€ã€å‰ç«¯å¯¼å‡º-Excel-è¡¨æ ¼çš„å®ç°" class="headerlink" title="ä¸€ã€å‰ç«¯å¯¼å‡º Excel è¡¨æ ¼çš„å®ç°"></a>ä¸€ã€å‰ç«¯å¯¼å‡º Excel è¡¨æ ¼çš„å®ç°</h2><h3 id="1ã€å®‰è£…-plugin"><a href="#1ã€å®‰è£…-plugin" class="headerlink" title="1ã€å®‰è£… plugin"></a>1ã€å®‰è£… plugin</h3><pre><code class="shell">npm install file-saver script-loader xlsx --save
</code></pre>
<h3 id="2ã€Export2Excel-å·¥å…·å‡½æ•°"><a href="#2ã€Export2Excel-å·¥å…·å‡½æ•°" class="headerlink" title="2ã€Export2Excel å·¥å…·å‡½æ•°"></a>2ã€Export2Excel å·¥å…·å‡½æ•°</h3><details>
<summary>ç‚¹æˆ‘å±•ç¤ºä»£ç </summary>

<pre><code class="js">import &#123; saveAs &#125; from &quot;file-saver&quot;;
import XLSX from &quot;xlsx&quot;;

function generateArray(table) &#123;
  var out = [];
  var rows = table.querySelectorAll(&quot;tr&quot;);
  var ranges = [];
  for (var R = 0; R &lt; rows.length; ++R) &#123;
    var outRow = [];
    var row = rows[R];
    var columns = row.querySelectorAll(&quot;td&quot;);
    for (var C = 0; C &lt; columns.length; ++C) &#123;
      var cell = columns[C];
      var colspan = cell.getAttribute(&quot;colspan&quot;);
      var rowspan = cell.getAttribute(&quot;rowspan&quot;);
      var cellValue = cell.innerText;
      if (cellValue !== &quot;&quot; &amp;&amp; cellValue == +cellValue) cellValue = +cellValue;

      //Skip ranges
      ranges.forEach(function (range) &#123;
        if (
          R &gt;= range.s.r &amp;&amp;
          R &lt;= range.e.r &amp;&amp;
          outRow.length &gt;= range.s.c &amp;&amp;
          outRow.length &lt;= range.e.c
        ) &#123;
          for (var i = 0; i &lt;= range.e.c - range.s.c; ++i) outRow.push(null);
        &#125;
      &#125;);

      //Handle Row Span
      if (rowspan || colspan) &#123;
        rowspan = rowspan || 1;
        colspan = colspan || 1;
        ranges.push(&#123;
          s: &#123;
            r: R,
            c: outRow.length,
          &#125;,
          e: &#123;
            r: R + rowspan - 1,
            c: outRow.length + colspan - 1,
          &#125;,
        &#125;);
      &#125;

      //Handle Value
      outRow.push(cellValue !== &quot;&quot; ? cellValue : null);

      //Handle Colspan
      if (colspan) for (var k = 0; k &lt; colspan - 1; ++k) outRow.push(null);
    &#125;
    out.push(outRow);
  &#125;
  return [out, ranges];
&#125;

function datenum(v, date1904) &#123;
  if (date1904) v += 1462;
  var epoch = Date.parse(v);
  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);
&#125;

function sheet_from_array_of_arrays(data, opts) &#123;
  var ws = &#123;&#125;;
  var range = &#123;
    s: &#123;
      c: 10000000,
      r: 10000000,
    &#125;,
    e: &#123;
      c: 0,
      r: 0,
    &#125;,
  &#125;;
  for (var R = 0; R != data.length; ++R) &#123;
    for (var C = 0; C != data[R].length; ++C) &#123;
      if (range.s.r &gt; R) range.s.r = R;
      if (range.s.c &gt; C) range.s.c = C;
      if (range.e.r &lt; R) range.e.r = R;
      if (range.e.c &lt; C) range.e.c = C;
      var cell = &#123;
        v: data[R][C],
      &#125;;
      if (cell.v == null) continue;
      var cell_ref = XLSX.utils.encode_cell(&#123;
        c: C,
        r: R,
      &#125;);

      if (typeof cell.v === &quot;number&quot;) cell.t = &quot;n&quot;;
      else if (typeof cell.v === &quot;boolean&quot;) cell.t = &quot;b&quot;;
      else if (cell.v instanceof Date) &#123;
        cell.t = &quot;n&quot;;
        cell.z = XLSX.SSF._table[14];
        cell.v = datenum(cell.v);
      &#125; else cell.t = &quot;s&quot;;

      ws[cell_ref] = cell;
    &#125;
  &#125;
  if (range.s.c &lt; 10000000) ws[&quot;!ref&quot;] = XLSX.utils.encode_range(range);
  return ws;
&#125;

function Workbook() &#123;
  if (!(this instanceof Workbook)) return new Workbook();
  this.SheetNames = [];
  this.Sheets = &#123;&#125;;
&#125;

function s2ab(s) &#123;
  var buf = new ArrayBuffer(s.length);
  var view = new Uint8Array(buf);
  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) &amp; 0xff;
  return buf;
&#125;

export function export_table_to_excel(id) &#123;
  var theTable = document.getElementById(id);
  var oo = generateArray(theTable);
  var ranges = oo[1];

  /* original data */
  var data = oo[0];
  var ws_name = &quot;SheetJS&quot;;

  var wb = new Workbook(),
    ws = sheet_from_array_of_arrays(data);

  /* add ranges to worksheet */
  // ws[&#39;!cols&#39;] = [&#39;apple&#39;, &#39;banan&#39;];
  ws[&quot;!merges&quot;] = ranges;

  /* add worksheet to workbook */
  wb.SheetNames.push(ws_name);
  wb.Sheets[ws_name] = ws;

  var wbout = XLSX.write(wb, &#123;
    bookType: &quot;xlsx&quot;,
    bookSST: false,
    type: &quot;binary&quot;,
  &#125;);

  saveAs(
    new Blob([s2ab(wbout)], &#123;
      type: &quot;application/octet-stream&quot;,
    &#125;),
    &quot;test.xlsx&quot;
  );
&#125;

export function export_json_to_excel(&#123;
  multiHeader = [],
  header,
  data,
  filename,
  merges = [],
  autoWidth = true,
  bookType = &quot;xlsx&quot;,
&#125; = &#123;&#125;) &#123;
  /* original data */
  filename = filename || &quot;excel-list&quot;;
  data = [...data];
  data.unshift(header);

  for (let i = multiHeader.length - 1; i &gt; -1; i--) &#123;
    data.unshift(multiHeader[i]);
  &#125;

  var ws_name = &quot;SheetJS&quot;;
  var wb = new Workbook(),
    ws = sheet_from_array_of_arrays(data);

  if (merges.length &gt; 0) &#123;
    if (!ws[&quot;!merges&quot;]) ws[&quot;!merges&quot;] = [];
    merges.forEach((item) =&gt; &#123;
      ws[&quot;!merges&quot;].push(XLSX.utils.decode_range(item));
    &#125;);
  &#125;

  if (autoWidth) &#123;
    /*è®¾ç½®worksheetæ¯åˆ—çš„æœ€å¤§å®½åº¦*/
    const colWidth = data.map((row) =&gt;
      row.map((val) =&gt; &#123;
        /*å…ˆåˆ¤æ–­æ˜¯å¦ä¸ºnull/undefined*/
        if (val == null) &#123;
          return &#123;
            wch: 10,
          &#125;;
        &#125; else if (val.toString().charCodeAt(0) &gt; 255) &#123;
          /*å†åˆ¤æ–­æ˜¯å¦ä¸ºä¸­æ–‡*/
          return &#123;
            wch: val.toString().length * 2,
          &#125;;
        &#125; else &#123;
          return &#123;
            wch: val.toString().length,
          &#125;;
        &#125;
      &#125;)
    );
    /*ä»¥ç¬¬ä¸€è¡Œä¸ºåˆå§‹å€¼*/
    let result = colWidth[0];
    for (let i = 1; i &lt; colWidth.length; i++) &#123;
      for (let j = 0; j &lt; colWidth[i].length; j++) &#123;
        if (result[j][&quot;wch&quot;] &lt; colWidth[i][j][&quot;wch&quot;]) &#123;
          result[j][&quot;wch&quot;] = colWidth[i][j][&quot;wch&quot;];
        &#125;
      &#125;
    &#125;
    ws[&quot;!cols&quot;] = result;
  &#125;

  /* add worksheet to workbook */
  wb.SheetNames.push(ws_name);
  wb.Sheets[ws_name] = ws;

  var wbout = XLSX.write(wb, &#123;
    bookType: bookType,
    bookSST: false,
    type: &quot;binary&quot;,
  &#125;);
  saveAs(
    new Blob([s2ab(wbout)], &#123;
      type: &quot;application/octet-stream&quot;,
    &#125;),
    `$&#123;filename&#125;.$&#123;bookType&#125;`
  );
&#125;
</code></pre>
</details>

<h3 id="3ã€å¯¼å‡ºå‡½æ•°"><a href="#3ã€å¯¼å‡ºå‡½æ•°" class="headerlink" title="3ã€å¯¼å‡ºå‡½æ•°"></a>3ã€å¯¼å‡ºå‡½æ•°</h3><p>a-button ä¸º ant-design-vue çš„ button ç»„ä»¶</p>
<pre><code class="html">&lt;a-button
  type=&quot;primary&quot;
  icon=&quot;export&quot;
  class=&quot;select-bottom&quot;
  :loading=&quot;exportLoading&quot;
  @click=&quot;handleExport&quot;
  &gt;å¯¼å‡º
&lt;/a-button&gt;
</code></pre>
<p>handleExport å¯¼å‡ºå‡½æ•°</p>
<blockquote>
<p>1ã€ç‚¹å‡»å¯¼å‡ºæŒ‰é’®ï¼Œå»åŠ è½½åœ¨ vendor æ–‡ä»¶å¤¹ä¸­çš„ Export2Excel æ¨¡å—<br>2ã€import æ–¹æ³•æ‰§è¡Œå®Œæ¯•è¿”å›ä¸€ä¸ª promise å¯¹è±¡ï¼Œåœ¨ then æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°ä½¿ç”¨çš„æ¨¡å—å¯¹è±¡ï¼ˆexcelï¼‰<br>3ã€Excel å¯¼å‡ºå‚æ•°éƒ¨åˆ†çš„ dataï¼Œæ˜¯ä¸€ä¸ªä¸¥æ ¼çš„äºŒç»´æ•°ç»„ï¼Œheader ä¸ºå¯¼å‡ºçš„æ•°æ®è¡¨å¤´ï¼Œfilename ä¸ºå¯¼å‡ºçš„æ–‡ä»¶åï¼ŒbookType ä¸ºå¯¼å‡ºæ–‡ä»¶ç±»å‹ï¼ŒautoWidth ä¸ºå•å…ƒæ ¼æ˜¯å¦è¦è‡ªé€‚åº”å®½åº¦ã€‚</p>
</blockquote>
<pre><code class="js">handleExport() &#123;
    //ç”±äºæ˜¯å‰ç«¯å¯¼å‡ºï¼Œæ‰€ä»¥åªèƒ½å¯¼å‡ºå½“å‰é¡µçš„æ•°æ®
    this.exportLoading = true;
      import(&#39;@/vendor/Export2Excel&#39;).then(excel =&gt; &#123;
        const header = [],
          filterVal = [];
        this.tableHead.forEach(item =&gt; &#123;
          if (item.title != &#39;æ“ä½œ&#39; &amp;&amp; item.title != &#39;åºå·&#39;) &#123;
            header.push(item.title);
            filterVal.push(item.dataIndex);
          &#125;
        &#125;);
        const data = formatJson(this.tableData, filterVal);

        excel.export_json_to_excel(&#123;
          header,
          data,
          filename: &#39;è¡¨å•ç»Ÿè®¡&#39;
        &#125;);
        this.exportLoading = false;
      &#125;);
    &#125;
</code></pre>
<h2 id="äºŒã€å‰ç«¯å¯¼å…¥-Excel-çš„å®ç°"><a href="#äºŒã€å‰ç«¯å¯¼å…¥-Excel-çš„å®ç°" class="headerlink" title="äºŒã€å‰ç«¯å¯¼å…¥ Excel çš„å®ç°"></a>äºŒã€å‰ç«¯å¯¼å…¥ Excel çš„å®ç°</h2><h3 id="1ã€ant-design-vue-ä¸Šä¼ ç»„ä»¶çš„ä½¿ç”¨"><a href="#1ã€ant-design-vue-ä¸Šä¼ ç»„ä»¶çš„ä½¿ç”¨" class="headerlink" title="1ã€ant-design-vue ä¸Šä¼ ç»„ä»¶çš„ä½¿ç”¨"></a>1ã€ant-design-vue ä¸Šä¼ ç»„ä»¶çš„ä½¿ç”¨</h3><pre><code class="html">&lt;div class=&quot;file-wrapper relative&quot;&gt;
  &lt;input
    ref=&quot;excel-upload&quot;
    type=&quot;file&quot;
    accept=&quot;.xlsx, .xls&quot;
    @change=&quot;handleChange&quot;
    style=&quot;display:none&quot;
  /&gt;
  &lt;a-button
    type=&quot;primary&quot;
    icon=&quot;file-excel&quot;
    size=&quot;large&quot;
    style=&quot;z-index:99&quot;
    @click=&quot;handleUpload&quot;
    :loading=&quot;loading&quot;
  &gt;
    ä¸Šä¼ Excel
  &lt;/a-button&gt;
  &lt;p class=&quot;text&quot;&gt;è¯·é€‰æ‹©Excelä¸Šä¼  æ”¯æŒ(xlsx,xls)æ ¼å¼&lt;/p&gt;
&lt;/div&gt;
&lt;!-- tableç»„ä»¶ tableData:[]  tableHead:[] --&gt;
&lt;a-card
  :hoverable=&quot;true&quot;
  :bordered=&quot;false&quot;
  v-if=&quot;tableHead.length &gt; 0&quot;
  style=&quot;margin-top:30px&quot;
&gt;
  &lt;standard-table
    :pagination=&quot;false&quot;
    :tableData=&quot;tableData&quot;
    :tableHead=&quot;tableHead&quot;
  /&gt;
&lt;/a-card&gt;
</code></pre>
<!-- æ ·å¼ -->

<pre><code class="css">.file-wrapper &#123;
  width: 100%;
  height: 350px;
  line-height: 350px;
  text-align: center;
  background: #e6ecf4;
  .text &#123;
    position: absolute;
    top: 50px;
    left: 50%;
    transform: translateX(-50%);
  &#125;
&#125;
</code></pre>
<h3 id="2ã€å¯¼å…¥å‡½æ•°"><a href="#2ã€å¯¼å…¥å‡½æ•°" class="headerlink" title="2ã€å¯¼å…¥å‡½æ•°"></a>2ã€å¯¼å…¥å‡½æ•°</h3><pre><code class="js">// å¼•å…¥xlsx tableç»„ä»¶
import XLSX from &quot;xlsx&quot;;
import standardTable from &quot;@/components/standardTable/index&quot;;
</code></pre>
<details>
<summary>ç‚¹æˆ‘å±•ç¤ºä»£ç </summary>

<pre><code class="js">    handleChange(e) &#123;
      const file = e.target.files[0];
      if (!file) return;
      //åˆ¤æ–­æ ¼å¼
      if (!this.isExcel(file)) &#123;
        this.$message.warning(&#39;åªèƒ½é€‰æ‹©xlxs,xlsæ–‡ä»¶&#39;);
        return;
      &#125;
      //åˆ¤æ–­å¤§å°
      if (file.size / 1024 / 1024 &gt; 1) &#123;
        this.$message.warning(&#39;ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡1M&#39;);
        return;
      &#125;
      this.loading = true;

      const reader = new FileReader();
      reader.readAsArrayBuffer(file);
      reader.onload = e =&gt; &#123;
        const data = e.target.result;
        const workbook = XLSX.read(data, &#123; type: &#39;array&#39; &#125;);
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];

        setTimeout(() =&gt; &#123;
          this.loading = false;
          const head = this.getHeaderRow(worksheet);
          this.tableHead = head.map(item =&gt; &#123;
            return &#123;
              title: item,
              dataIndex: item
            &#125;;
          &#125;);
          const tableData = XLSX.utils.sheet_to_json(worksheet);
          tableData.forEach(item =&gt; &#123;
            item.id = parseInt(Math.random(0, 1) * 10000);
          &#125;);
          this.tableData = tableData;
        &#125;, 500);
      &#125;;
    &#125;,

    generateData(&#123; header, results &#125;) &#123;
      this.excelData.header = header;
      this.excelData.results = results;
      this.onSuccess &amp;&amp; this.onSuccess(this.excelData);
    &#125;,

    //è·å–è¡¨å¤´
    getHeaderRow(sheet) &#123;
      const headers = [];
      const range = XLSX.utils.decode_range(sheet[&#39;!ref&#39;]);
      let C;
      const R = range.s.r;

      for (C = range.s.c; C &lt;= range.e.c; ++C) &#123;
        const cell = sheet[XLSX.utils.encode_cell(&#123; c: C, r: R &#125;)];
        let hdr = &#39;UNKNOWN &#39; + C;
        if (cell &amp;&amp; cell.t) hdr = XLSX.utils.format_cell(cell);
        headers.push(hdr);
      &#125;
      return headers;
    &#125;,

    handleUpload() &#123;
      this.$refs[&#39;excel-upload&#39;].click();
    &#125;,
    // æ–‡ä»¶ç±»å‹
    isExcel(file) &#123;
      return /\.(xlsx|xls|csv)$/.test(file.name);
    &#125;
</code></pre>
</details>

<h2 id="ä¸‰ã€table-å­ç»„ä»¶"><a href="#ä¸‰ã€table-å­ç»„ä»¶" class="headerlink" title="ä¸‰ã€table å­ç»„ä»¶"></a>ä¸‰ã€table å­ç»„ä»¶</h2><details>
<summary>ç‚¹æˆ‘å±•ç¤ºä»£ç </summary>

<pre><code class="html">&lt;div class=&quot;tableCommon-wrapper&quot;&gt;
  &lt;a-table
    :columns=&quot;tableHead&quot;
    :dataSource=&quot;tableData&quot;
    :loading=&quot;loading&quot;
    :pagination=&quot;pagination&quot;
    :row-selection=&quot;rowSelection&quot;
    @change=&quot;handleTableChange&quot;
    rowKey=&quot;id&quot;
    :scroll=&quot;scroll&quot;
  &gt;
    &lt;template
      slot-scope=&quot;text, record, index&quot;
      :slot=&quot;slot&quot;
      v-for=&quot;slot in Object.keys($scopedSlots).filter(key =&gt; key !== &#39;expandedRowRender&#39;)&quot;
    &gt;
      &lt;slot :name=&quot;slot&quot; v-bind=&quot;&#123; text, record, index &#125;&quot;&gt;&lt;/slot&gt;
    &lt;/template&gt;
  &lt;/a-table&gt;
&lt;/div&gt;
</code></pre>
<pre><code class="js">export default &#123;
  name: &quot;standardTable&quot;,
  props: &#123;
    tableHead: &#123;
      type: Array,
      required: true,
    &#125;,
    tableData: &#123;
      type: Array,
      required: true,
    &#125;,
    loading: &#123;
      type: Boolean,
      default: false,
    &#125;,
    pagination: &#123;
      type: Boolean | Object,
    &#125;,
    rowSelection: &#123;
      type: Object,
    &#125;,
    scroll: &#123;
      type: Object,
    &#125;,
  &#125;,
  methods: &#123;
    handleTableChange(val) &#123;
      this.$emit(&quot;changeCurrent&quot;, val.current);
    &#125;,
  &#125;,
&#125;;
</code></pre>
</details>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/01/19/webrtc/" title="WebRTCéŸ³è§†é¢‘"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">ä¸Šä¸€é¡µ: WebRTCéŸ³è§†é¢‘</span></a><a class="button is-default" href="/2022/01/13/count-to/" title="CountTo:æ•°å­—åŠ¨æ€æ»šåŠ¨"><span class="has-text-weight-semibold">ä¸‹ä¸€é¡µ: CountTo:æ•°å­—åŠ¨æ€æ»šåŠ¨</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- çŸ¥ä¹--><!-- é¢†è‹±--><!-- è„¸ä¹¦--></section><p><span>Copyright Â©</span><span> Jude 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>