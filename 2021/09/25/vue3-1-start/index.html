<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>vue3-èµ·å§‹å’Œæ–°ç‰¹æ€§</title><meta name="description" content="ğŸ¯ ğŸ¯ ğŸ¯ ğŸ¯ ğŸ¯"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="ä½¿ç”¨ vite åˆ›å»ºé¡¹ç›®ï¼Œä»¥åŠ vue3 çš„ composition API çš„ä½¿ç”¨


ä¸€ã€åˆ›å»ºé¡¹ç›®ï¼ˆvue-cli + viteï¼‰ä½¿ç”¨ vite å¯ä»¥æ›´åŠ å¿«é€Ÿçš„å¯åŠ¨é¡¹ç›®
npm init vite-app &amp;lt;project-name&amp;gt;

cd project-name

npm install &amp;amp;&amp;amp; npm run dev

äºŒã€main.jsimport &amp;#123; createApp &amp;#125; from &amp;quot;vue&amp;quot;;
import App from &amp;quot;./App.vue&amp;quot;;
import &amp;quot;./index.css&amp;quot;;

createApp(App).mount(&amp;quot;#app&amp;quot;);

ä¸‰ã€ç»„.."><meta name="generator" content="Hexo 5.4.1"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Jude's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">vue3-èµ·å§‹å’Œæ–°ç‰¹æ€§</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">ç‚¹å‡»è¿”å›é¡¶éƒ¨</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/about">å…³äº</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/about">å…³äº</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%EF%BC%88vue-cli-vite%EF%BC%89"><span class="toc-text">ä¸€ã€åˆ›å»ºé¡¹ç›®ï¼ˆvue-cli + viteï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81main-js"><span class="toc-text">äºŒã€main.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BB%84%E5%90%88%E5%BC%8F-API%EF%BC%9Acomposition-API"><span class="toc-text">ä¸‰ã€ç»„åˆå¼ APIï¼šcomposition API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">ï¼ˆä¸€ï¼‰ã€åŸºæœ¬ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E5%88%9B%E5%BB%BA%E5%93%8D%E5%BA%94%E5%BC%8F%E5%AF%B9%E8%B1%A1"><span class="toc-text">ï¼ˆäºŒï¼‰ã€åˆ›å»ºå“åº”å¼å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89-%E3%80%81%E5%8D%95%E5%80%BC%E5%93%8D%E5%BA%94%E5%BC%8F%E5%A3%B0%E6%98%8E%EF%BC%9Aref"><span class="toc-text">(ä¸‰)ã€å•å€¼å“åº”å¼å£°æ˜ï¼šref</span></a></li></ol></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/vue3"><i class="tag post-item-tag">vue3</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">vue3-èµ·å§‹å’Œæ–°ç‰¹æ€§</h1><time class="has-text-grey" datetime="2021-09-25T02:00:00.000Z">2021-09-25</time><article class="mt-2 post-content"><p>ä½¿ç”¨ vite åˆ›å»ºé¡¹ç›®ï¼Œä»¥åŠ vue3 çš„ composition API çš„ä½¿ç”¨</p>
<span id="more"></span>

<h2 id="ä¸€ã€åˆ›å»ºé¡¹ç›®ï¼ˆvue-cli-viteï¼‰"><a href="#ä¸€ã€åˆ›å»ºé¡¹ç›®ï¼ˆvue-cli-viteï¼‰" class="headerlink" title="ä¸€ã€åˆ›å»ºé¡¹ç›®ï¼ˆvue-cli + viteï¼‰"></a>ä¸€ã€åˆ›å»ºé¡¹ç›®ï¼ˆvue-cli + viteï¼‰</h2><p>ä½¿ç”¨ vite å¯ä»¥æ›´åŠ å¿«é€Ÿçš„å¯åŠ¨é¡¹ç›®</p>
<pre><code class="js">npm init vite-app &lt;project-name&gt;

cd project-name

npm install &amp;&amp; npm run dev
</code></pre>
<h2 id="äºŒã€main-js"><a href="#äºŒã€main-js" class="headerlink" title="äºŒã€main.js"></a>äºŒã€main.js</h2><pre><code class="js">import &#123; createApp &#125; from &quot;vue&quot;;
import App from &quot;./App.vue&quot;;
import &quot;./index.css&quot;;

createApp(App).mount(&quot;#app&quot;);
</code></pre>
<h2 id="ä¸‰ã€ç»„åˆå¼-APIï¼šcomposition-API"><a href="#ä¸‰ã€ç»„åˆå¼-APIï¼šcomposition-API" class="headerlink" title="ä¸‰ã€ç»„åˆå¼ APIï¼šcomposition API"></a>ä¸‰ã€ç»„åˆå¼ APIï¼šcomposition API</h2><blockquote>
<p>composition api ä¸º Vue åº”ç”¨æä¾›æ›´å¥½çš„é€»è¾‘å¤ç”¨å’Œä»£ç ç»„ç»‡ã€‚</p>
</blockquote>
<p>setup()é’©å­æ˜¯åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ç»„åˆå¼ API çš„å…¥å£ï¼Œé€šå¸¸åªåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä½¿ç”¨ï¼š</p>
<p>1ã€éœ€è¦åœ¨éå•æ–‡ä»¶ç»„ä»¶ä¸­ä½¿ç”¨ç»„åˆå¼ API æ—¶ã€‚</p>
<p>2ã€éœ€è¦åœ¨åŸºäºé€‰é¡¹å¼ API çš„ç»„ä»¶ä¸­é›†æˆåŸºäºç»„åˆå¼ API çš„ä»£ç æ—¶ã€‚</p>
<h4 id="ï¼ˆä¸€ï¼‰ã€åŸºæœ¬ä½¿ç”¨"><a href="#ï¼ˆä¸€ï¼‰ã€åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ï¼ˆä¸€ï¼‰ã€åŸºæœ¬ä½¿ç”¨"></a>ï¼ˆä¸€ï¼‰ã€åŸºæœ¬ä½¿ç”¨</h4><pre><code class="js">&lt;script&gt;
import &#123; ref &#125; from &#39;vue&#39;

export default &#123;
  setup() &#123;
    const count = ref(0)

    // è¿”å›å€¼ä¼šæš´éœ²ç»™æ¨¡æ¿å’Œå…¶ä»–çš„é€‰é¡¹å¼ API é’©å­
    return &#123;
      count
    &#125;
  &#125;,

  mounted() &#123;
    console.log(this.count) // 0
  &#125;
&#125;
&lt;/script&gt;
</code></pre>
<pre><code class="html">&lt;template&gt;
  &lt;button @click=&quot;count++&quot;&gt;&#123;&#123; count &#125;&#125;&lt;/button&gt;
&lt;/template&gt;
</code></pre>
<blockquote>
<blockquote>
<p>Tipï¼š setup() è‡ªèº«å¹¶ä¸å«å¯¹ç»„ä»¶å®ä¾‹çš„è®¿é—®æƒï¼Œå³åœ¨ setup() ä¸­è®¿é—® this ä¼šæ˜¯ undefinedã€‚ä½ å¯ä»¥åœ¨é€‰é¡¹å¼ API ä¸­è®¿é—®ç»„åˆå¼ API æš´éœ²çš„å€¼ï¼Œä½†åè¿‡æ¥åˆ™ä¸è¡Œã€‚</p>
</blockquote>
</blockquote>
<h4 id="ï¼ˆäºŒï¼‰ã€åˆ›å»ºå“åº”å¼å¯¹è±¡"><a href="#ï¼ˆäºŒï¼‰ã€åˆ›å»ºå“åº”å¼å¯¹è±¡" class="headerlink" title="ï¼ˆäºŒï¼‰ã€åˆ›å»ºå“åº”å¼å¯¹è±¡"></a>ï¼ˆäºŒï¼‰ã€åˆ›å»ºå“åº”å¼å¯¹è±¡</h4><p>æ–¹æ³•1ã€</p>
<pre><code class="html">&lt;p&gt;&#123;&#123; data.counter &#125;&#125;&lt;/p&gt;
&lt;p&gt;&#123;&#123; data.doubleCounter &#125;&#125;&lt;/p&gt;
</code></pre>
<pre><code class="js">import &#123; computed,reactive,onMounted,onUnmounted,ref,toRefs,watch&#125; from &quot;vue&quot;;

export default &#123;
  setup() &#123;
    const data = reactive(&#123;
      counter: 1,
      doubleCounter: computed(() =&gt; data.counter * 2),
    &#125;);

    const msg1 = ref(&quot;some message&quot;);
    // setup æœ€æ—©æœ‰onMounted æ— created beforeCreate

    &#125;,
    let timer;
    onMounted(() =&gt; &#123;
      timer = setInterval(() =&gt; &#123;
        data.counter++;
      &#125;, 1000);
    &#125;);
    onUnmounted(() =&gt; &#123;
      clearInterval(timer);
    &#125;);
    return &#123; data, msg1 &#125;;
  &#125;,
&#125;;
</code></pre>
<p>æ–¹æ³• 2ï¼štoRefs:è§£æ„/å±•å¼€è¿”å›å“åº”å¼å¯¹è±¡</p>
<pre><code class="html">  &lt;p&gt;&#123;&#123; msg1 &#125;&#125;&lt;/p&gt;
  &lt;p&gt;&#123;&#123; counter &#125;&#125;&lt;/p&gt;
  &lt;p&gt;&#123;&#123; doubleCounter &#125;&#125;&lt;/p&gt;
  &lt;p ref=&quot;desc&quot;&gt;&lt;/p&gt;
</code></pre>
<pre><code class="js">import &#123; computed,reactive,onMounted,onUnmounted,ref,toRefs,watch&#125; from &quot;vue&quot;;
export default &#123;
  setup() &#123;
    // useCounterå‡½æ•°ä½¿ç”¨äº†toRefs  æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å±•å¼€ä½¿ç”¨counter doubleCounter
    const &#123; counter, doubleCounter &#125; = useCounter();

    // å•å€¼å“åº”å¼
    const msg1 = ref(&quot;some message&quot;);

    // ä½¿ç”¨å…ƒç´ 
    const desc = ref(null);

    // watch ä¾¦å¬å™¨
    watch(counter, (val, oldVal) =&gt; &#123;
      // è¿™é‡Œéœ€è¦åŠ ä¸Šdesc.value
      const p = desc.value;
      p.textContent = `counter change from $&#123;oldVal&#125; to $&#123;val&#125;`;
    &#125;);
    return &#123; counter, doubleCounter, msg1, desc &#125;;
  &#125;,
&#125;;

function useCounter() &#123;
  const data = reactive(&#123;
    counter: 1,
    doubleCounter: computed(() =&gt; data.counter * 2),
  &#125;);

  // setup æœ€æ—©æœ‰onMounted æ— created
  let timer;
  onMounted(() =&gt; &#123;
    timer = setInterval(() =&gt; &#123;
      data.counter++;
    &#125;, 1000);
  &#125;);
  onUnmounted(() =&gt; &#123;
    clearInterval(timer);
  &#125;);
  return toRefs(data);
&#125;
</code></pre>
<h5 id="ä¸‰-ã€å•å€¼å“åº”å¼å£°æ˜ï¼šref"><a href="#ä¸‰-ã€å•å€¼å“åº”å¼å£°æ˜ï¼šref" class="headerlink" title="(ä¸‰)ã€å•å€¼å“åº”å¼å£°æ˜ï¼šref"></a>(ä¸‰)ã€å•å€¼å“åº”å¼å£°æ˜ï¼šref</h5><pre><code class="js">const msg1 = ref(&quot;some msg&quot;);
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2021/10/02/vue3-2-teleport/" title="vue3-ä¼ é€é—¨ï¼šteleport"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">ä¸Šä¸€é¡µ: vue3-ä¼ é€é—¨ï¼šteleport</span></a><a class="button is-default" href="/2021/06/20/egg/" title="åˆè¯†egg.js"><span class="has-text-weight-semibold">ä¸‹ä¸€é¡µ: åˆè¯†egg.js</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Jude"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- çŸ¥ä¹--><!-- é¢†è‹±--><!-- è„¸ä¹¦--></section><p><span>Copyright Â©</span><span> Jude 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>